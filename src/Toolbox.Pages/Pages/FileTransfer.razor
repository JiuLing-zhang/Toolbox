@page "/file-transfer"

@inject NavigationManager NavigationManager

<PageTitle>码术 - 文件传输</PageTitle>

<MudPaper Width="100%" Elevation="0">
    <MudContainer MaxWidth="MaxWidth.Small">
        <MudPaper Width="100%"
                  Square="true"
                  Class="pa-5 mt-10 d-flex flex-column align-center">
            <MudText>点对点文件传输</MudText>

            <MudTextField @bind-Value="RoomId"
                          Class="mt-10"
                          T="string"
                          Label="请输入4位数字的房间号"
                          Variant="Variant.Text" />
            <MudButtonGroup Color="Color.Info"
                            Class="mt-4"
                            Variant="Variant.Filled">
                <MudButton OnClick="@(async () => await GotoCreateRoomPageAsync(1))">创建</MudButton>
                <MudButton OnClick="@(async () => await GotoCreateRoomPageAsync(0))">加入</MudButton>
            </MudButtonGroup>
        </MudPaper>
    </MudContainer>
</MudPaper>
@code
{
    public string RoomId { get; set; } = JiuLing.CommonLibs.RandomUtils.GetOneByLength(6);
    private Task GotoCreateRoomPageAsync(int roomType)
    {
        int roomId;
        if (int.TryParse(RoomId, out roomId))
        {
            if (roomId >= 100000 && roomId <= 999999)
            {
                NavigationManager.NavigateTo($"/file-transfer/{roomType}/{RoomId}");
            }
        }
        return Task.CompletedTask;
    }
}